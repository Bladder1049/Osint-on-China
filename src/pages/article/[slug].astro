---
// Component imports
import Layout from "@layout"
import { ArticleSlice } from "@component/articles"

// Fetch all articles
const articles = await Astro.glob("../../../_articles/*.md")

// Fetch static paths
export const getStaticPaths = async () => {
	// Fetch all articles
	const articles = await Astro.glob("../../../_articles/*.md")

	return articles.map((article) => {
		return {
			params: {
				slug: article.frontmatter.title.toLocaleLowerCase().split(" ").join("-")
			},
			props: { ...article }
		}
	})
}

const { slug } = Astro.params
const { frontmatter } = Astro.props

// Find related articles
const relatedArticles = articles.filter((article) => {
	return article.frontmatter.relatedArticles.includes(
		frontmatter.relatedArticles[0] || frontmatter.relatedArticles[1]
	)
})

const data = { slug, frontmatter }
---

<Layout
	title={data.frontmatter.title}
	description={data.frontmatter.description}
	image={data.frontmatter.thumbnail}
>
	<ArticleSlice data={data} />
</Layout>
